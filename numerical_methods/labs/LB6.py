import numpy as np
import math

import matplotlib.pyplot as plt
from scipy.optimize import fsolve

# Ð Ð•Ð¨Ð•ÐÐ˜Ð• ÐÐ•Ð›Ð˜ÐÐ•Ð™ÐÐ«Ð¥ Ð£Ð ÐÐ’ÐÐ•ÐÐ˜Ð™
def y(x): #ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸
    return np.sin(x)-x**2*np.cos(x)

def func_fsolve():
    # Ð¢Ð•Ð¥ÐÐžÐ›ÐžÐ“Ð˜Ð¯ ÐžÐŸÐ Ð•Ð”Ð•Ð›Ð•ÐÐ˜Ð¯ Ð’Ð•Ð©Ð•Ð¡Ð¢Ð’Ð•ÐÐÐ«Ð¥ ÐšÐžÐ ÐÐ•Ð™
    # Ð£Ð ÐÐ’ÐÐ•ÐÐ˜Ð¯ Ð¡ ÐŸÐžÐœÐžÐ©Ð¬Ð® Ð¤Ð£ÐÐšÐ¦Ð˜Ð˜ fsolve()

    """
    ÐŸÑ€Ð¸ Ñ€ÐµÑˆÐµÐ½Ð¸Ð¸ Ð½ÐµÐ»Ð¸Ð½ÐµÐ¹Ð½Ñ‹Ñ… ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ð¹ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ
    fsolve() Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸ optimize.scipy. Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ fsolve Ð¾ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð»ÑÐµÑ‚ Ð½Ð°Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ
    ÐºÐ¾Ñ€Ð½ÐµÐ¹ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ð¹ Ð¿Ð¾ Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ð¼Ñƒ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸ÑŽ.
    Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸:
    fsolve (Ð¸Ð¼Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸, Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸Ðµ)
    ÐŸÐµÑ€ÐµÐ´ Ð½Ð°Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸ÐµÐ¼ ÐºÐ¾Ñ€Ð½ÐµÐ¹ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¿Ð¾ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ð³Ñ€Ð°Ñ„Ð¸Ðº Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð´Ð»Ñ
    Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ° Ñ ÐºÐ¾Ñ€Ð½ÐµÐ¼ ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ.
    """
    x = np.linspace(-5, 5, 100)  # Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ° Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ñ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ°
    y = [math.sin(n * math.pi / 180.0) - n ** 2 * math.cos(n * math.pi / 180.0) for n in x]
    # Ð·Ð°Ð¿Ð¸ÑÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸
    fig, ax = plt.subplots()  # Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¼ÐµÑÑ‚Ð° Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð½Ð° Ñ€Ð¸ÑÑƒÐ½ÐºÐµ
    ax.plot(x, y, color="blue", label="y(x)")  # Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ñ†Ð²ÐµÑ‚Ð° Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð¸ Ð½Ð°Ð´Ð¿Ð¸ÑÐ¸
    ax.set_xlabel("x")  # Ð¿Ð¾Ð´Ð¿Ð¸ÑÑŒ Ñƒ Ð³Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¾ÑÐ¸ Ñ…
    ax.set_ylabel("y")  # Ð¿Ð¾Ð´Ð¿Ð¸ÑÑŒ Ñƒ Ð²ÐµÑ€Ñ‚Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¾ÑÐ¸ y
    ax.legend()  # Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð»ÐµÐ³ÐµÐ½Ð´Ñ‹
    plt.grid(True)  # Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ ÑÐµÑ‚ÐºÐ¸ Ð½Ð° Ð³Ñ€Ð°Ñ„Ð¸ÐºÐµ
    plt.show()  # Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ€Ð¸ÑÑƒÐ½Ð¾Ðº

def init_gr1():
    t = fsolve(y, (-1, 1))  # Ð²Ñ‹Ð·Ð¾Ð² Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð´Ð»Ñ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ
    print(t)  # Ð²Ñ‹Ð²Ð¾Ð´ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°

# Ð’Ð«Ð§Ð˜Ð¡Ð›Ð•ÐÐ˜Ð• ÐšÐžÐ ÐÐ•Ð™ ÐŸÐžÐ›Ð˜ÐÐžÐœÐ
def func_polynom():
    """
    ÐÐ°Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ ÑÑ€Ð°Ð·Ñƒ Ð²ÑÐµÑ… ÐºÐ¾Ñ€Ð½ÐµÐ¹ Ð¿Ð¾Ð»Ð¸Ð½Ð¾Ð¼Ð° Ð¾ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð»ÑÐµÑ‚ÑÑ Ð¿Ñ€Ð¸ Ð¿Ð¾Ð¼Ð¾Ñ‰Ð¸
    Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ roots(Ñ€), Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð²ÐµÐºÑ‚Ð¾Ñ€ Ñ
    ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚Ð°Ð¼Ð¸ Ð¿Ð¾Ð»Ð¸Ð½Ð¾Ð¼Ð°. Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ roots Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð²ÐµÐºÑ‚Ð¾Ñ€ ÐºÐ¾Ñ€Ð½ÐµÐ¹ Ð¿Ð¾Ð»Ð¸Ð½Ð¾Ð¼Ð°:
    ÐŸÐ¾Ð»Ð¸Ð½Ð¾Ð¼ Ð² PYTHON Ð·Ð°Ð´Ð°ÐµÑ‚ÑÑ Ð²ÐµÐºÑ‚Ð¾Ñ€Ð¾Ð¼ ÐµÐ³Ð¾ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚Ð¾Ð². ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€,
    Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð»Ð¸Ð½Ð¾Ð¼Ð° ð‘¥4 âˆ’ 11x3 + 9x2 + 11x âˆ’ 10Ð¸Ð¼ÐµÐµÑ‚ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ Ð²Ð¸Ð´:
    """
    p = np.array([1, -11, 9, 11, -10])
    t = np.roots(p)
    print(t)

    """
    Ð§Ð¸ÑÐ»Ð¾ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð² Ð²ÐµÐºÑ‚Ð¾Ñ€Ð°, Ñ‚.Ðµ. Ñ‡Ð¸ÑÐ»Ð¾ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚Ð¾Ð² Ð¿Ð¾Ð»Ð¸Ð½Ð¾Ð¼Ð°, Ð²ÑÐµÐ³Ð´Ð° Ð½Ð°
    ÐµÐ´Ð¸Ð½Ð¸Ñ†Ñƒ Ð±Ð¾Ð»ÑŒÑˆÐµ ÐµÐ³Ð¾ ÑÑ‚ÐµÐ¿ÐµÐ½Ð¸. Ð§Ñ‚Ð¾Ð±Ñ‹ ÑƒÐ¹Ñ‚Ð¸ Ð¾Ñ‚ ÐºÐ¾Ð¼Ð¿Ð»ÐµÐºÑÐ½Ñ‹Ñ… Ñ‡Ð¸ÑÐµÐ» Ð¿Ñ€Ð¸ Ð²Ñ‹Ð²Ð¾Ð´Ðµ
    Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ð¾ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒÑÑ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÐµÐ¹ z.real (Ð¸Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ Ñ‡Ð¸ÑÐ»Ð° Ñ Ð¿Ð»Ð°Ð²Ð°ÑŽÑ‰ÐµÐ¹ Ñ‚Ð¾Ñ‡ÐºÐ¾Ð¹)
    """
    print(t.real)

    """
    ÐŸÐµÑ€ÐµÐ´Ð°Ð²Ð°Ñ ÑÐ¿Ð¸ÑÐ¾Ðº ÐºÐ¾Ñ€Ð½ÐµÐ¹ Ð¿Ð¾Ð»Ð¸Ð½Ð¾Ð¼Ð°, Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ poly(Ñ€) Ð¼Ð¾Ð¶Ð½Ð¾
    Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚Ñ‹ ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ
    """
    p = np.array([10, -1, 1, 1])
    t = np.poly(p)
    print(t)

# Ð Ð•Ð¨Ð•ÐÐ˜Ð• ÐÐ•Ð›Ð˜ÐÐ•Ð™ÐÐžÐ“Ðž Ð£Ð ÐÐ’ÐÐ•ÐÐ˜Ð¯ ÐœÐ•Ð¢ÐžÐ”ÐžÐœ Ð‘Ð˜Ð¡Ð•ÐšÐ¦Ð˜Ð˜
def f(x):
    return x*x*x - np.cos(x) + 1

def init_gr2():
    eps = 0.00001
    a = -0.5
    b = 0.5

    while abs(a - b) > eps:
        c = (a + b)  / 2
        if (f(c) * f(a)) < 0:
            b = c
        else:
            a = c
    print(round(c, 2))

def func_bisection():
    """
    Ð¡ÑƒÑ‚ÑŒ Ð¼ÐµÑ‚Ð¾Ð´Ð°: ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð¾Ñ‚Ñ€ÐµÐ·Ð¾Ðº Ð¿Ð¾Ð¸ÑÐºÐ° Ñ€ÐµÑˆÐµÐ½Ð¸Ñ [a;b], ÑÐ½Ð°Ñ‡Ð°Ð»Ð° Ð½Ð°Ñ…Ð¾Ð´ÑÑ‚
    Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð² Ñ‚Ð¾Ñ‡ÐºÐµ ÑÐµÑ€ÐµÐ´Ð¸Ð½Ñ‹ c, Ð³Ð´Ðµ c = (a+b)/2. Ð—Ð°Ñ‚ÐµÐ¼ ÑÑ€Ð°Ð²Ð½Ð¸Ð²Ð°ÑŽÑ‚ Ð·Ð½Ð°ÐºÐ¸
    f(a) Ð¸ f(c). Ð•ÑÐ»Ð¸ Ð·Ð½Ð°ÐºÐ¸ Ñ€Ð°Ð·Ð½Ñ‹Ðµ â€” Ñ‚Ð¾ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð½Ð° Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐµ [a;c], ÐµÑÐ»Ð¸ Ð½ÐµÑ‚
    â€” Ñ‚Ð¾ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð½Ð° Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐµ [c;b]. Ð¢Ð°ÐºÐ¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼ ÑÐ¾ÐºÑ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ Ð¾Ð±Ð»Ð°ÑÑ‚ÑŒ Ð²
    2 Ñ€Ð°Ð·Ð°. Ð¢Ð°ÐºÐ¾Ðµ ÑÐ¾ÐºÑ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ð¸ Ð´Ð°Ð»ÑŒÑˆÐµ, Ð¿Ð¾ÐºÐ° Ð½Ðµ Ð±ÑƒÐ´ÐµÑ‚ Ð´Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚Ð°
    Ð·Ð°Ð´Ð°Ð½Ð½Ð°Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ.
    """
    # ÐŸÐµÑ€ÐµÐ´ Ð½Ð°Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸ÐµÐ¼ ÐºÐ¾Ñ€Ð½Ñ ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¿Ð¾ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ð³Ñ€Ð°Ñ„Ð¸Ðº Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸
    # Ð´Ð»Ñ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ° Ñ ÐºÐ¾Ñ€Ð½ÐµÐ¼ ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ
    x = np.linspace(-1, 1, 100)
    y = [n*n*n - math.cos(n*math.pi / 100.0) + 1 for n in x]
    fig, ax = plt.subplots()
    ax.plot(x, y, color="blue", label="y(x)")
    ax.set_xlabel("x")
    ax.set_ylabel("y")
    ax.legend()
    plt.grid(True)
    plt.show()

if __name__ == '__main__':
    # f(a)*f(a+s)
    # f`(a)=(f(a+s)-f(a))/s

    # func_fsolve()
    # init_gr()

    # func_polynom()

    func_bisection()

    init_gr2()